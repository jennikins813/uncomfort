<p> <%= link_to "Quiz", "/quizzes/new" %> </p>

<h1>Comfort Friends</h1>

<%= form_tag users_path, method: :get, authentication: false, id: 'search-form' do %>
	<%= text_field_tag :search, params[:search] %>
	<%= submit_tag "Search User" %>
<% end %>

<div id="users">
	<%= render @users %>
</div>


<div id="tag_cloud">
	<% tag_cloud User.tag_counts, %w[s m l] do |tag, css_class| %>
		<%= link_to tag.name, tag_path(tag.name), class: css_class %>
	<% end %>	
</div>

<script type="text/javascript">
  function display_search_results() {
    if (this.readyState === 4) {
      console.log(this);
      document.getElementById('users').innerHTML = this.responseText;
    }
  }

  var form = document.getElementById('search-form');
  form.addEventListener('submit', function(event) {
    event.preventDefault();

    var searchValue = document.getElementById('search').value;

    var xhr = new XMLHttpRequest();
    xhr.onload = display_search_results;
    xhr.open('GET', '/users/search?search=' + searchValue, true);
    xhr.send();
  });
</script>